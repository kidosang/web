<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- 부트스트랩 ver5.1.3 css/js -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- CSS 링크 -->
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <!-- 로고 헤더 -->
    <header class='logo container-fluid mt-1'>
        <div class="navbar navbar-expand-sm bg-white navbar-white">
            <a class='navbar-brand' href="index.html">
                <img src='hamster.png' alt='Logo' style='width:40px;' class='rounded-pill'>
            </a>
        </div>
    </header>

    <!-- 로그인 회원가입란 -->
    <nav class='person container-fluid'>
        <div>
            <ul class="nav justify-content-end">
                <li class='nav-item'>
                    <a class="nav-link" href="login.html">로그인</a>
                </li>
                <li class='nav-item'>
                    <a class="nav-link" href="join.html">회원가입</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- 시작 화면 -->
    <section class='container-xxl'>
        <article class='start'>
            <h1 class='mt-5 text-center'>유형 테스트</h1>
            <button type="button" class="btn btn-primary mt-5" onclick='start();'>테스트 시작하기</button>
        </article>
        <!-- 문제 화면 -->
        <article class='question'>
            <div class='move'>
                <a href="javascript:window.history.back()">
                    <button onclick='history.back()'>&lt</button>  
                </a>
            </div>
            <div class='progress mt-5'>
                <div class="progress-bar progress-bar-striped progress-bar-animated" style="width:calc(100/12*1%)">
                </div>
            </div>
            <h2 id='title' class='mt-5 text-center'></h2>
            <input type="hidden" id='type' value="EI">
            <button type="button" id='A' class="btn btn-outline-primary mt-5">Primary</button>
            <button type="button" id='B' class="btn btn-outline-primary mt-5">Primary</button>
        </article>
        <!-- 결과 화면 -->
        <article class='result'>
            <img id='img' src='hamster.png' class="rounded-circle mt-5" alt='animal'>
            <h2 id='animal' class='mt-5 text-center'>결과</h2>
            <h3 id='explain' class='mt-5 text-center'>설명</h3>
            <div class="share addthis_inline_share_toolbox mt-5"></div>
        </article>
    </section>
    <footer>

    </footer>
    <!-- 타입 구분용 value값 내부적으로 저장 -->
    <input type='hidden' id='EI' value='0'>
    <input type='hidden' id='SN' value='0'>
    <input type='hidden' id='TF' value='0'>
    <input type='hidden' id='JP' value='0'>

    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script>
        //문제 번호를 나타내는 변수 num, 1번부터 시작
        let num = 1;
        //각 문제별로, 해당 문제들의 정보를 저장한 자바스크립트 객체 q
        let q = {
            1: { 'title': '문제 1번', 'type': 'EI', 'A': 'E', 'B': 'I' },
            2: { 'title': '문제 2번', 'type': 'EI', 'A': 'E', 'B': 'I' },
            3: { 'title': '문제 3번', 'type': 'EI', 'A': 'E', 'B': 'I' },
            4: { 'title': '문제 4번', 'type': 'SN', 'A': 'S', 'B': 'N' },
            5: { 'title': '문제 5번', 'type': 'SN', 'A': 'S', 'B': 'N' },
            6: { 'title': '문제 6번', 'type': 'SN', 'A': 'S', 'B': 'N' },
            7: { 'title': '문제 7번', 'type': 'TF', 'A': 'T', 'B': 'F' },
            8: { 'title': '문제 8번', 'type': 'TF', 'A': 'T', 'B': 'F' },
            9: { 'title': '문제 9번', 'type': 'TF', 'A': 'T', 'B': 'F' },
            10: { 'title': '문제 10번', 'type': 'JP', 'A': 'J', 'B': 'P' },
            11: { 'title': '문제 11번', 'type': 'JP', 'A': 'J', 'B': 'P' },
            12: { 'title': '문제 12번', 'type': 'JP', 'A': 'J', 'B': 'P' },
        };
        // mbti의 결과를 key로 삼아 그에 해당하는 내용을 저장한 자바스크립트 객체 result
        let result = {
            "ESTJ": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ESTP": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ESFJ": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ESFP": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ENTJ": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ENTP": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ENFJ": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ENFP": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ISTJ": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ISTP": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ISFJ": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "ISFP": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "INTJ": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "INTP": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "INFJ": { 'animal': '햄스터', 'explain': '햄스터 설명', 'img': 'hamster.png' },
            "INFP": { 'animal': '고양이', 'explain': '고양이 설명', 'img': 'cat.png' }
        }
        // 시작화면의 '테스트 시작하기' 버튼 클릭 시 시작화면 숨기고, 문제화면을 보이며, 문제도 함께 시작되는 기능 
        function start() {
            $('.person').hide();
            $('.start').hide();
            $('.question').show();
            next();
        };
        // A버튼을 눌렀을때는 value값이 누적되고, 다음문제로 넘어가는 기능
        $('#A').click(function () {
            let type = $('#type').val();
            let preValue = $('#' + type).val();
            $('#' + type).val(parseInt(preValue) + 1);
            next();
            // B버튼을 눌렀을때는 value값 누적 없이 그냥 넘어가는 기능
        });
        $('#B').click(function () {
            next();
        })
        // 다음 문제로 넘어가는 next 기능은 마지막 문제까지의 시점과, 마지막 문제를 넘어선 시점을 나눔 
        function next() {
            // 마지막 문제가 끝난 이후에는 문제화면을 숨기고, 결과화면을 보여줌 + 각 문제를 풀면서 A버튼을 누를때 누적되었던 value값을 이용해 최종적으로 테스트의 결과를 만들어주는 기능 + 결과화면 내용 출력  
            if (num == 13) {
                $('.question').hide();
                $('.result').show();
                let mbti = '';
                ($('#EI').val() >= 2) ? mbti += 'E' : mbti += 'I';
                ($('#SN').val() >= 2) ? mbti += 'S' : mbti += 'N';
                ($('#TF').val() >= 2) ? mbti += 'T' : mbti += 'F';
                ($('#JP').val() >= 2) ? mbti += 'J' : mbti += 'P';
                $('#img').attr('src', result[mbti]['img']);
                $('#animal').html(result[mbti]['animal']);
                $('#explain').html(result[mbti]['explain']);
                //12개의 문제가 진행중일때는 progress bar가 점차 증가하는 기능 + 자바스크립트 객체 q에서 num(문제번호)을 key로 삼아 해당 문제의 정보들을 가져옴 + 다음 문제로 넘어가도록 num++  
            } else {
                $('.progress-bar').attr('style', 'width:calc(100/12*' + num + '%)');
                $('#title').html(q[num]['title']);
                $('#type').val(q[num]['type']);
                $('#A').html(q[num]['A']);
                $('#B').html(q[num]['B']);
                num++;
            }
        }

    </script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-61e1101a28242308"></script>
</body>

</html>